<?xml version="1.0" encoding="UTF-8"?>

<!--
Configuration for the innermost ring of a Geronimo server.
This configuration should only contain critical services needed to
run other Configurations - for example, the ServerInfo, Logging
and Repository services used to load them.

This configuration should *NOT* be used to provide server or application
specific services - those should be provided by children.
-->
<configuration
    xmlns="http://geronimo.apache.org/xml/ns/deployment"
    configId="org/apache/geronimo/System"
    >

    <include>
        <uri>geronimo/jars/geronimo-system-DEV.jar</uri>
    </include>
    <include>
        <uri>log4j/jars/log4j-1.2.8.jar</uri>
    </include>

    <!-- ServerInfo service -->
    <gbean name="geronimo.system:role=ServerInfo" class="org.apache.geronimo.system.serverinfo.ServerInfo">
    </gbean>

    <!-- Logging service -->
    <gbean name="geronimo.system:role=Logger" class="org.apache.geronimo.system.logging.log4j.Log4jService">
        <attribute name="RefreshPeriod" type="int">60</attribute>
        <attribute name="ConfigurationURL" type="java.net.URL">log4j.xml</attribute>
        <reference name="ServerInfo">geronimo.system:role=ServerInfo</reference>
    </gbean>

    <gbean name="geronimo.system:role=LogAppender,type=ConsoleAppender" class="org.apache.geronimo.system.logging.log4j.appender.ConsoleAppenderService">
        <attribute name="Threshold" type="java.lang.String">INFO</attribute>
        <attribute name="LayoutPattern" type="java.lang.String">%d{ABSOLUTE} %-5p [%c{1}] %m%n</attribute>
        <attribute name="Target" type="java.lang.String">System.out</attribute>
    </gbean>

    <gbean name="geronimo.system:role=LogAppender,type=DailyRollingFileAppender" class="org.apache.geronimo.system.logging.log4j.appender.RollingFileAppenderService">
        <attribute name="Threshold" type="java.lang.String">DEBUG</attribute>
        <attribute name="LayoutPattern" type="java.lang.String">%d{ABSOLUTE} %-5p [%c{1}] %m%n</attribute>
        <attribute name="Append" type="boolean">true</attribute>
        <attribute name="File" type="java.lang.String">var/log/geronimo.log</attribute>
        <attribute name="BufferedIO" type="boolean">false</attribute>
        <attribute name="BufferedSize" type="int">8192</attribute>
        <attribute name="MaxBackupIndex" type="int">1</attribute>
        <attribute name="MaxFileSize" type="java.lang.String">10MB</attribute>
        <reference name="ServerInfo">geronimo.system:role=ServerInfo</reference>
    </gbean>

    <!-- Repository -->
    <gbean name="geronimo.system:role=Repository" class="org.apache.geronimo.system.repository.ReadOnlyRepository">
        <attribute name="Root" type="java.net.URI">repository/</attribute>
        <reference name="ServerInfo">geronimo.system:role=ServerInfo</reference>
    </gbean>
</configuration>