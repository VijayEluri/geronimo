<?xml version="1.0" encoding="ISO-8859-1"?>
<!--

    Copyright 2004-2005 The Apache Software Foundation

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at
  
       http://www.apache.org/licenses/LICENSE-2.0
  
    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
  

<!-- $Rev: 46019 $ $Date: 2004-09-14 05:56:06 -0400 (Tue, 14 Sep 2004) $ -->

<project default="default"
    xmlns:j="jelly:core"
    xmlns:ant="jelly:ant"
    >

    <!--
      #
      # Be carefull about changing the package prefix.  When generating the java
      # files for the .IDL files, they will normally go into a package that
      # corresponds with the module.  I originally had o.a.g.i.org.omg as the
      # prefix, but the idlj tool would generate the GIOP in a wrong package:
      # o.a.g.i.org.omg.o.a.g.i for some strange reason.
    -->

    <!--
      # Todo:
      #
      # 1. It would be nice to improve the iop, giop, iiop, cosnaming targets as their
      #    build goals are almost the same.  Maybe we could figure out how to use a for
      #    script statement....
      #
      # 2. Run the idlj targets only if the idl files were changed.  Figure out how
      #    to add a dependency check....
      #
      # 3. ....
      #
    -->

    <goal name="interop:idlj:iop">
        <j:set var="pkg.prefix" value="org.apache.geronimo.interop"/>
        <ant:echo message="Interop :: idlj :: IOP"/>
        <ant:exec dir="${basedir}" executable="idlj">
            <ant:arg value="-td"/>
            <ant:arg file="${maven.build.src}"/>
            <ant:arg value="-i"/>
            <ant:arg file="${java.home}/lib"/>
            <ant:arg value="-i"/>
            <ant:arg file="${maven.src.dir}/idl"/>
            <ant:arg value="-verbose"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="GIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="CosNaming"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg file="${maven.src.dir}/idl/IOP.idl"/>
        </ant:exec>
    </goal>

    <goal name="interop:idlj:giop">
        <j:set var="pkg.prefix" value="org.apache.geronimo.interop"/>
        <ant:echo message="Interop :: idlj :: GIOP"/>
        <ant:exec dir="${basedir}" executable="idlj">
            <ant:arg value="-td"/>
            <ant:arg value="${maven.build.src}"/>
            <ant:arg value="-i"/>
            <ant:arg file="${java.home}/lib"/>
            <ant:arg value="-i"/>
            <ant:arg file="${maven.src.dir}/idl"/>
            <ant:arg value="-verbose"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="GIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="CosNaming"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg file="${maven.src.dir}/idl/GIOP.idl"/>
        </ant:exec>
    </goal>

    <goal name="interop:idlj:iiop">
        <j:set var="pkg.prefix" value="org.apache.geronimo.interop"/>
        <ant:echo message="Interop :: idlj :: IIOP"/>
        <ant:exec dir="${basedir}" executable="idlj">
            <ant:arg value="-td"/>
            <ant:arg value="${maven.build.src}"/>
            <ant:arg value="-i"/>
            <ant:arg file="${java.home}/lib"/>
            <ant:arg value="-i"/>
            <ant:arg file="${maven.src.dir}/idl"/>
            <ant:arg value="-verbose"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="GIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="CosNaming"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg file="${maven.src.dir}/idl/IIOP.idl"/>
        </ant:exec>
    </goal>

    <goal name="interop:idlj:cosnaming">
        <j:set var="pkg.prefix" value="org.apache.geronimo.interop"/>
        <ant:echo message="Interop :: idlj :: CosNaming"/>
        <ant:exec dir="${basedir}" executable="idlj">
            <ant:arg value="-td"/>
            <ant:arg value="${maven.build.src}"/>
            <ant:arg value="-i"/>
            <ant:arg file="${java.home}/lib"/>
            <ant:arg value="-i"/>
            <ant:arg file="${maven.src.dir}/idl"/>
            <ant:arg value="-verbose"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="GIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="CosNaming"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg file="${maven.src.dir}/idl/CosNaming.idl"/>
        </ant:exec>
    </goal>

    <goal name="interop:idlj:interop-rmi-iiop">
        <j:set var="pkg.prefix" value="org.apache.geronimo.interop"/>
        <ant:echo message="Interop :: idlj :: interop-rmi-iiop"/>
        <ant:exec dir="${basedir}" executable="idlj">
            <ant:arg value="-td"/>
            <ant:arg value="${maven.build.src}"/>
            <ant:arg value="-i"/>
            <ant:arg file="${java.home}/lib"/>
            <ant:arg value="-i"/>
            <ant:arg file="${maven.src.dir}/idl"/>
            <ant:arg value="-verbose"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="GIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="CosNaming"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg file="${maven.src.dir}/idl/org-apache-geronimo-interop-rmi-iiop.idl"/>
        </ant:exec>
    </goal>

    <goal name="interop:idlj:csi">
        <ant:echo message="Interop :: idlj :: CSIv2 :: CSI"/>
        <ant:exec dir="${basedir}" executable="idlj">
            <ant:arg value="-td"/>
            <ant:arg value="${maven.build.src}"/>
            <ant:arg value="-i"/>
            <ant:arg file="${java.home}/lib"/>
            <ant:arg value="-i"/>
            <ant:arg file="${maven.src.dir}/idl"/>
            <ant:arg value="-verbose"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="GIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="CosNaming"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="CSI"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="GSSUP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="CSIIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg file="${maven.src.dir}/idl/CSI.idl"/>
        </ant:exec>

        <ant:echo message="Interop :: idlj :: CSIv2 :: GSSUP"/>
        <ant:exec dir="${basedir}" executable="idlj">
            <ant:arg value="-td"/>
            <ant:arg value="${maven.build.src}"/>
            <ant:arg value="-i"/>
            <ant:arg file="${java.home}/lib"/>
            <ant:arg value="-i"/>
            <ant:arg file="${maven.src.dir}/idl"/>
            <ant:arg value="-verbose"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="GIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="CosNaming"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="CSI"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="GSSUP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="CSIIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg file="${maven.src.dir}/idl/GSSUP.idl"/>
        </ant:exec>
        
	<ant:echo message="Interop :: idlj :: CSIv2 :: CSIIOP"/>
	<ant:exec dir="${basedir}" executable="idlj">
	    <ant:arg value="-td"/>
	    <ant:arg value="${maven.build.src}"/>
	    <ant:arg value="-i"/>
	    <ant:arg file="${java.home}/lib"/>
	    <ant:arg value="-i"/>
	    <ant:arg file="${maven.src.dir}/idl"/>
	    <ant:arg value="-verbose"/>
	    <ant:arg value="-pkgPrefix"/>
	    <ant:arg value="IOP"/>
	    <ant:arg value="${pkg.prefix}"/>
	    <ant:arg value="-pkgPrefix"/>
	    <ant:arg value="IIOP"/>
	    <ant:arg value="${pkg.prefix}"/>
	    <ant:arg value="-pkgPrefix"/>
	    <ant:arg value="GIOP"/>
	    <ant:arg value="${pkg.prefix}"/>
	    <ant:arg value="-pkgPrefix"/>
	    <ant:arg value="CosNaming"/>
	    <ant:arg value="${pkg.prefix}"/>
	    <ant:arg value="-pkgPrefix"/>
	    <ant:arg value="CSI"/>
	    <ant:arg value="${pkg.prefix}"/>
	    <ant:arg value="-pkgPrefix"/>
	    <ant:arg value="GSSUP"/>
	    <ant:arg value="${pkg.prefix}"/>
	    <ant:arg value="-pkgPrefix"/>
	    <ant:arg value="CSIIOP"/>
	    <ant:arg value="${pkg.prefix}"/>
	    <ant:arg file="${maven.src.dir}/idl/CSIIOP.idl"/>
	</ant:exec>
    </goal>

    <goal name="interop:idlj:security-service">
        <ant:echo message="Interop :: idlj :: SecurityService :: TimeBase"/>
        <ant:exec dir="${basedir}" executable="idlj">
            <ant:arg value="-td"/>
            <ant:arg value="${maven.build.src}"/>
            <ant:arg value="-i"/>
            <ant:arg file="${java.home}/lib"/>
            <ant:arg value="-i"/>
            <ant:arg file="${maven.src.dir}/idl"/>
            <ant:arg value="-verbose"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="GIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="CosNaming"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="TimeBase"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="SecurityService"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg file="${maven.src.dir}/idl/TimeBase.idl"/>
        </ant:exec>

        <ant:echo message="Interop :: idlj :: SecurityService :: SecurityService"/>
        <ant:exec dir="${basedir}" executable="idlj">
            <ant:arg value="-td"/>
            <ant:arg value="${maven.build.src}"/>
            <ant:arg value="-i"/>
            <ant:arg file="${java.home}/lib"/>
            <ant:arg value="-i"/>
            <ant:arg file="${maven.src.dir}/idl"/>
            <ant:arg value="-verbose"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="GIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="CosNaming"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="TimeBase"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="SecurityService"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg file="${maven.src.dir}/idl/Security.idl"/>
        </ant:exec>

        <ant:echo message="Interop :: idlj :: SecurityService :: SSLIOP"/>
        <ant:exec dir="${basedir}" executable="idlj">
            <ant:arg value="-td"/>
            <ant:arg value="${maven.build.src}"/>
            <ant:arg value="-i"/>
            <ant:arg file="${java.home}/lib"/>
            <ant:arg value="-i"/>
            <ant:arg file="${maven.src.dir}/idl"/>
            <ant:arg value="-verbose"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="GIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="CosNaming"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="TimeBase"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="SecurityService"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg file="${maven.src.dir}/idl/SSLIOP.idl"/>
        </ant:exec>

    </goal>

    <goal name="interop:idlj:costxn">
        <!-- Are there any CosTransaction IDL files that require generation? -->
        <j:set var="pkg.prefix" value="org.apache.geronimo.interop"/>
        <ant:echo message="Interop :: idlj :: CosTransactions"/>
        <ant:exec dir="${basedir}" executable="idlj">
            <ant:arg value="-td"/>
            <ant:arg value="${maven.build.src}"/>
            <ant:arg value="-i"/>
            <ant:arg file="${java.home}/lib"/>
            <ant:arg value="-i"/>
            <ant:arg file="${maven.src.dir}/idl"/>
            <ant:arg value="-verbose"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="GIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="CosNaming"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="TimeBase"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="CosTransactions"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="CosTSInteroperation"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="CosTSPortability"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg file="${maven.src.dir}/idl/CosTransactions.idl"/>
        </ant:exec>
        
        <ant:echo message="Interop :: idlj :: CosTSInteroperation"/>
        <ant:exec dir="${basedir}" executable="idlj">
            <ant:arg value="-td"/>
            <ant:arg value="${maven.build.src}"/>
            <ant:arg value="-i"/>
            <ant:arg file="${java.home}/lib"/>
            <ant:arg value="-i"/>
            <ant:arg file="${maven.src.dir}/idl"/>
            <ant:arg value="-verbose"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="IIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="GIOP"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="CosNaming"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="TimeBase"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="CosTransactions"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="CosTSInteroperation"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg value="-pkgPrefix"/>
            <ant:arg value="CosTSPortability"/>
            <ant:arg value="${pkg.prefix}"/>
            <ant:arg file="${maven.src.dir}/idl/CosTSInteroperation.idl"/>
        </ant:exec>
    </goal>

    <goal name="interop:java:compile">
        <ant:echo message="Interop :: Compile"/>
        <ant:javac srcdir="${maven.build.src}" destdir="${maven.build.dest}"
            classpath="${maven.build.dest};${maven.build.src}"/>
    </goal>

    <goal name="interop:idlj">
        <attainGoal name="interop:idlj:iop"/>
        <attainGoal name="interop:idlj:giop"/>
        <attainGoal name="interop:idlj:iiop"/>
        <attainGoal name="interop:idlj:cosnaming"/>
        <attainGoal name="interop:idlj:interop-rmi-iiop"/>
        <attainGoal name="interop:idlj:csi"/>
        <attainGoal name="interop:idlj:security-service"/>
        <attainGoal name="interop:idlj:costxn"/>
    </goal>

    <preGoal name="java:compile">
        <attainGoal name="interop:idlj"/>
        <attainGoal name="interop:java:compile"/>
    </preGoal>

</project>
