<?xml version="1.0" encoding="UTF-8"?>
<components>
    <class-space name="geronimo.system:role=ClassSpace,name=System"/>

    <!-- ============================================================ -->
    <!-- Starts the remoting async://0.0.0.0:3434 transport           -->
    <!-- ============================================================ -->
    <mbean code="org.apache.geronimo.remoting.transport.TransportLoader"
            name="geronimo.remoting:transport=async">
        <attribute name="BindURI">async://0.0.0.0:3434</attribute>
        <attribute name="RouterTarget">geronimo.remoting:router=SubsystemRouter</attribute>
        <depends name="geronimo.remoting:router=SubsystemRouter"/>
    </mbean>

    <!-- ============================================================ -->
    <!-- Sets up the SubSystem router.                                -->
    <!-- ============================================================ -->
    <mbean code="org.apache.geronimo.remoting.router.SubsystemRouter" 
            name="geronimo.remoting:router=SubsystemRouter">
    </mbean>

    <mbean code="org.apache.geronimo.common.jmx.Relationship"
           name="geronimo.remoting:role=Relationship,name=Route">
        <constructor>
            <arg type="java.lang.String">
                name=Route
                left.name=Source
                right.name=Target
                right.class=org.apache.geronimo.remoting.router.RouterTargetMBean
            </arg>
        </constructor>
    </mbean>

    <!-- ============================================================ -->
    <!-- Sets up the JMX Router.                                      -->
    <!--  This router Uses ObjectNames to route invocations.          -->
    <!-- Sample URI to Target:                                        -->
    <!--   async://localhost:3434/JMX#geronimo.test:service=Test      -->
    <!-- ============================================================ -->
    <mbean code="org.apache.geronimo.remoting.router.JMXRouter" 
            name="geronimo.remoting:router=JMXRouter">
        <depends name="geronimo.remoting:role=Relationship,name=Route"/>
        <relationship type="Route" name="/JMX" role="Target" 
                target="geronimo.remoting:router=SubsystemRouter" targetRole="Source"/>
    </mbean>    

    <!-- ============================================================ -->
    <!-- Sets up the InterceptorRegistry Router.                      -->
    <!--  This router uses dynamic oids (generated by the             -->
    <!--  InterceptorRegistry) to route invocations.                  -->
    <!-- Sample URI to Target:                                        -->
    <!--   async://localhost:3434/Remoting#121                        -->
    <!-- ============================================================ -->
    <mbean code="org.apache.geronimo.remoting.router.InterceptorRegistryRouter" 
            name="geronimo.remoting:router=InterceptorRegistryRouter">
        <depends name="geronimo.remoting:role=Relationship,name=Route"/>
        <relationship type="Route" name="/Remoting" role="Target" 
                target="geronimo.remoting:router=SubsystemRouter" targetRole="Source"/>
    </mbean>    

    <!-- ============================================================ -->
    <!-- Expose the MBeanServer via remoting URI                      -->
    <!--   async://localhost:3434/JMX#geronimo.jmx:target=MBeanServerStub -->
    <!-- ============================================================ -->
    <mbean code="org.apache.geronimo.remoting.jmx.MBeanServerStub"
            name="geronimo.remoting:target=MBeanServerStub">
    </mbean>    


</components>
