<?xml version="1.0" encoding="UTF-8"?>

<!-- $Revision: 1.5 $ $Date: 2004/02/17 07:26:47 $ -->

<project default="default"
    xmlns:ant="jelly:ant"
    xmlns:j="jelly:core">

    <!-- ================= -->
    <!-- Global Properties -->
    <!-- ================= -->

    <!-- Determine what the top-level project root is -->
    <j:set var="project.root" value="${pom.parentBasedir().getParentFile().getCanonicalFile()}"/>

    <!-- Load the global properties -->
    <ant:property file="${project.root}/etc/global.properties"/>


    <!-- ==================== -->
    <!-- Default Global Goals -->
    <!-- ==================== -->

    <goal name="default">
        <attainGoal name="jar:jar"/>
        <ant:property name="pluginsDir" value="${maven.repo.local}/${pom.artifactDirectory}/plugins"/>
        <ant:mkdir dir="${pluginsDir}"/>
        <ant:copy
            file="${basedir}/target/${pom.artifactId}-${pom.currentVersion}.jar"
            todir="${pluginsDir}"
            overwrite="true"
            />
    </goal>

    <goal name="build">
        <attainGoal name="default"/>
    </goal>

    <goal name="rebuild">
        <attainGoal name="clean"/>
        <attainGoal name="build"/>
    </goal>

    <goal name="clover.wrapper">
        <!-- no src/test, don't run clover -->
        <!--attainGoal name="clover"/-->
    </goal>

    <!-- Remove the log files -->
    <goal name="clobber"
        description="Removes all (non-repository installed) build generated files">

        <!-- Let clean:clean do some work first -->
        <attainGoal name="clean:clean"/>

        <j:jelly xmlns="jelly:ant">
            <delete quiet="false" failonerror="false">
                <fileset dir="${basedir}">
                    <include name="maven.log"/>
                    <include name="velocity.log*"/>
                    <include name="junit*.properties"/>
                </fileset>
            </delete>
        </j:jelly>
    </goal>
</project>
