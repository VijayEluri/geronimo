<?xml version="1.0" encoding="UTF-8"?>

<!-- $Id: maven.xml,v 1.2 2003/08/13 11:07:51 jdillon Exp $ -->

<project
  xmlns:j="jelly:core"
  xmlns:u="jelly:util"
  xmlns:ant="jelly:ant"
  xmlns:castor="castor">
  
  <!-- ===================== -->
  <!-- Module Initialization -->
  <!-- ===================== -->
  
  <ant:property file="${basedir}/../../etc/project.properties"/>
  
  
  <!-- ================================= -->
  <!-- Compile XML->Java Binding Sources -->
  <!-- ================================= -->
  
  <preGoal name="java:compile">
    <attainGoal name="castor:prepare-filesystem"/>
      
    <!-- this does not currently support -binding-file 
    <castor:generate schema="${basedir}/src/schema/twiddle-configuration.xsd"
                     package="org.apache.geronimo.twiddle.config"
                     marshal="false"
                     types="j2"/>
    -->
    
    <j:set var="schema" value="${basedir}/src/schema/twiddle-configuration.xsd"/>
    <j:set var="gen" value="${pom.getPluginContext('maven-castor-plugin').getVariable('maven.castor.dest')}"/>
    
    <ant:java className="org.exolab.castor.builder.SourceGenerator"
              failonerror="true">
      <ant:arg value="-i"/>
      <ant:arg value="${schema}"/>
      <ant:arg value="-binding-file"/>
      <ant:arg value="${basedir}/src/etc/twiddle-configuration-binding.xml"/>
      <ant:arg value="-package"/>
      <ant:arg value="org.apache.geronimo.twiddle.config"/>
      <ant:arg value="-types"/>
      <ant:arg value="j2"/>
      <ant:arg value="-nomarshall"/>
      <ant:arg value="-f"/>
      <ant:arg value="-dest"/>
      <ant:arg value="${gen}"/>
    </ant:java>
    
  </preGoal>

</project>