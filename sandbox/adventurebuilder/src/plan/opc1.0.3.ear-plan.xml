<?xml version="1.0" encoding="UTF-8"?>
<!--

    Copyright 2005 The Apache Software Foundation

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<!-- $Rev$ $Date$ -->
<application xmlns="http://geronimo.apache.org/xml/ns/j2ee/application"
    parentId="org/apache/geronimo/AdventureDataSource1.0.1"
    configId="org/apache/geronimo/OPC1.0.3">
    <import>
        <uri>org/apache/geronimo/AdventureBuilderJMS</uri>
    </import>
    <dependency>
        <uri>geronimo/geronimo-common/${geronimo_version}/jar</uri>
    </dependency>
    <dependency>
        <uri>geronimo/geronimo-mail/${geronimo_version}/jar</uri>
    </dependency>
    <dependency>
        <uri>geronimo-spec/geronimo-spec-activation/${geronimo_spec_activation_version}/jar</uri>
    </dependency>
    <dependency>
        <uri>geronimo-spec/geronimo-spec-javamail/${geronimo_spec_javamail_version}/jar</uri>
    </dependency>
    <module>
        <ejb>opc-ejb.jar</ejb>
        <openejb-jar xmlns="http://www.openejb.org/xml/ns/openejb-jar"
            xmlns:naming="http://geronimo.apache.org/xml/ns/naming" 
            xmlns:sys="http://geronimo.apache.org/xml/ns/deployment"
            configId="NOT_USED">
            <cmp-connection-factory>
                <resource-link>AdventureDataSource</resource-link>
            </cmp-connection-factory>
            <enterprise-beans>
                <session>
                    <ejb-name>PoEndpointBean</ejb-name>
                    <jndi-name>PoEndpointBean</jndi-name>
                    <resource-ref>
                        <ref-name>jms/opc/QueueConnectionFactory</ref-name>
                        <resource-link>AdventureBuilderConnectionFactory</resource-link>     
                    </resource-ref>
                    <naming:resource-env-ref>
                        <naming:ref-name>jms/opc/WorkFlowMgrQueue</naming:ref-name>
                        <naming:message-destination-link>jms/opc/WorkFlowMgrQueue</naming:message-destination-link>
                    </naming:resource-env-ref>
                    <web-service-address>http://localhost:8080/webservice/PoEndpointBean</web-service-address>     
                </session>
                <session>
                    <ejb-name>BrokerServiceBean</ejb-name>
                    <jndi-name>BrokerServiceBean</jndi-name>
                    <resource-ref>
                        <ref-name>jms/opc/QueueConnectionFactory</ref-name>
                        <resource-link>AdventureBuilderConnectionFactory</resource-link>        
                    </resource-ref>
                    <naming:resource-env-ref>
                        <naming:ref-name>jms/opc/WorkFlowMgrQueue</naming:ref-name>
                        <naming:message-destination-link>jms/opc/WorkFlowMgrQueue</naming:message-destination-link>
                    </naming:resource-env-ref>
                    <web-service-address>http://localhost:8080/webservice/WebServiceBroker</web-service-address>
                </session>
                <session>
                    <ejb-name>OtEndpointBean</ejb-name>
                    <jndi-name>OtEndpointBean</jndi-name>
                    <ejb-local-ref>
                        <ref-name>ejb/local/processmanager/ProcessManager</ref-name>
                        <name>ProcessManagerBean</name>
                    </ejb-local-ref>
                    <ejb-local-ref>
                        <ref-name>ejb/local/purchaseorder/PurchaseOrder</ref-name>
                        <name>PurchaseOrderBean</name>
                    </ejb-local-ref>
                    <web-service-address>http://localhost:8080/webservice/OtEndpointBean</web-service-address>
                </session>
                <message-driven>
                    <ejb-name>WorkFlowManagerBean</ejb-name>
                    <resource-adapter>
                        <resource-link>Adventure Builder JMS Resources</resource-link>
                    </resource-adapter>
                    <activation-config>
                        <activation-config-property>
                            <activation-config-property-name>destination</activation-config-property-name>
                            <activation-config-property-value>jms/opc/WorkFlowMgrQueue</activation-config-property-value>
                        </activation-config-property>
                        <activation-config-property>
                            <activation-config-property-name>destinationType</activation-config-property-name>
                            <activation-config-property-value>javax.jms.Queue</activation-config-property-value>
                        </activation-config-property>
                    </activation-config>
                    <naming:service-ref>
                        <naming:service-ref-name>service/CreditCardService</naming:service-ref-name>
                        <naming:port>
                            <naming:port-name>CreditCardIntfPort</naming:port-name>
                            <naming:protocol>http</naming:protocol>
                            <naming:host>localhost</naming:host>
                            <naming:port>8080</naming:port>
                            <naming:uri>/activity/foo/as</naming:uri>
                        </naming:port>
                    </naming:service-ref>
                    <resource-ref>
                        <ref-name>jms/opc/QueueConnectionFactory</ref-name>
                        <resource-link>AdventureBuilderConnectionFactory</resource-link>
                    </resource-ref>
                    <naming:resource-env-ref>
                        <naming:ref-name>jms/opc/OrderFillerQueue</naming:ref-name>
                        <naming:message-destination-link>jms/opc/OrderFillerQueue</naming:message-destination-link>
                    </naming:resource-env-ref>
                    <naming:resource-env-ref>
                        <naming:ref-name>jms/opc/CRMQueue</naming:ref-name>
                        <naming:message-destination-link>jms/opc/CRMQueue</naming:message-destination-link>
                    </naming:resource-env-ref>
                </message-driven>
                <message-driven>
                    <ejb-name>OrderFillerBean</ejb-name>
                    <resource-adapter>
                        <resource-link>Adventure Builder JMS Resources</resource-link>
                    </resource-adapter>
                    <activation-config>
                        <activation-config-property>
                            <activation-config-property-name>destination</activation-config-property-name>
                            <activation-config-property-value>jms/opc/OrderFillerQueue</activation-config-property-value>
                        </activation-config-property>
                        <activation-config-property>
                            <activation-config-property-name>destinationType</activation-config-property-name>
                            <activation-config-property-value>javax.jms.Queue</activation-config-property-value>
                        </activation-config-property>
                    </activation-config>
                    <resource-ref>
                        <ref-name>jms/opc/QueueConnectionFactory</ref-name>
                        <resource-link>AdventureBuilderConnectionFactory</resource-link>
                    </resource-ref>
                    <naming:resource-env-ref>
                        <naming:ref-name>jms/opc/WebServiceBrokerQueue</naming:ref-name>
                        <naming:message-destination-link>jms/opc/WebServiceBrokerQueue</naming:message-destination-link>
                    </naming:resource-env-ref>
                </message-driven>
                <message-driven>
                    <ejb-name>BrokerRequestorBean</ejb-name>
                    <resource-adapter>
                        <resource-link>Adventure Builder JMS Resources</resource-link>
                    </resource-adapter>
                    <activation-config>
                        <activation-config-property>
                            <activation-config-property-name>destination</activation-config-property-name>
                            <activation-config-property-value>jms/opc/BrokerRequestorTopic</activation-config-property-value>
                        </activation-config-property>
                        <activation-config-property>
                            <activation-config-property-name>destinationType</activation-config-property-name>
                            <activation-config-property-value>javax.jms.Topic</activation-config-property-value>
                        </activation-config-property>
                    </activation-config>
                    <naming:service-ref>
                        <naming:service-ref-name>service/ActivityPOService</naming:service-ref-name>
                        <naming:port>
                            <naming:port-name>ActivityPOIntfPort</naming:port-name>
                            <naming:protocol>http</naming:protocol>
                            <naming:host>localhost</naming:host>
                            <naming:port>8080</naming:port>
                            <naming:uri>/activity/foo/as</naming:uri>
                        </naming:port>
                    </naming:service-ref>
                    <naming:service-ref>
                        <naming:service-ref-name>service/LodgingPOService</naming:service-ref-name>
                        <naming:port>
                            <naming:port-name>LodgingPOIntfPort</naming:port-name>
                            <naming:protocol>http</naming:protocol>
                            <naming:host>localhost</naming:host>
                            <naming:port>8080</naming:port>
                            <naming:uri>/activity/foo/as</naming:uri>
                        </naming:port>
                    </naming:service-ref>
                    <naming:service-ref>
                        <naming:service-ref-name>service/AirlinePOService</naming:service-ref-name>
                        <naming:port>
                            <naming:port-name>AirlinePOIntfPort</naming:port-name>
                            <naming:protocol>http</naming:protocol>
                            <naming:host>localhost</naming:host>
                            <naming:port>8080</naming:port>
                            <naming:uri>/activity/foo/as</naming:uri>
                        </naming:port>
                    </naming:service-ref>
                    <resource-ref>
                        <ref-name>jms/opc/QueueConnectionFactory</ref-name>
                        <resource-link>AdventureBuilderConnectionFactory</resource-link>        
                    </resource-ref>
                </message-driven>
                <entity>
                    <ejb-name>AddressBean</ejb-name>
                    <jndi-name>AddressLocalHome</jndi-name>
                    <table-name>Address</table-name>
                    <cmp-field-mapping>
                        <cmp-field-name>streetName1</cmp-field-name>
                        <table-column>streetName1</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>streetName2</cmp-field-name>
                        <table-column>streetName2</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>city</cmp-field-name>
                        <table-column>city</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>state</cmp-field-name>
                        <table-column>state</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>postalCode</cmp-field-name>
                        <table-column>postalCode</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>country</cmp-field-name>
                        <table-column>country</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>addressBean_upk</cmp-field-name>
                        <cmp-field-class>java.lang.Integer</cmp-field-class>
                        <table-column>AddressBean_upk</table-column>
                        <sql-type>INTEGER</sql-type>
                        <type-converter>org.tranql.sql.typeconverter.SerializableConverter</type-converter>
                    </cmp-field-mapping>
                    <primkey-field>addressBean_upk</primkey-field>     
                    <key-generator>
                        <auto-increment-table>
                            <sql>INSERT INTO Address VALUES(null,streetName1,streetName2,city,state,postalCode,country)</sql>
                            <return-type>java.lang.Integer</return-type>
                        </auto-increment-table>
                    </key-generator>
                    <resource-ref>
                        <ref-name>jdbc/adventure/AdventureDB</ref-name>
                        <resource-link>AdventureDataSource</resource-link>
                    </resource-ref>
                </entity>
                <entity>
                    <ejb-name>ContactInfoBean</ejb-name>
                    <jndi-name>ContactInfoLocalHome</jndi-name>
                    <table-name>ContactInfo</table-name>
                    <cmp-field-mapping>
                        <cmp-field-name>phone</cmp-field-name>
                        <table-column>phone</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>email</cmp-field-name>
                        <table-column>email</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>givenName</cmp-field-name>
                        <table-column>givenName</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>familyName</cmp-field-name>
                        <table-column>familyName</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>contactInfoBean_upk</cmp-field-name>
                        <cmp-field-class>java.lang.Integer</cmp-field-class>
                        <table-column>ContactInfoBean_upk</table-column>
                        <sql-type>INTEGER</sql-type>
                        <type-converter>org.tranql.sql.typeconverter.SerializableConverter</type-converter>
                    </cmp-field-mapping>
                    <primkey-field>contactInfoBean_upk</primkey-field> 
                    <key-generator>
                        <auto-increment-table>
                            <sql>INSERT INTO ContactInfo VALUES(null,phone,email,givenName,familyName,null)</sql>
                            <return-type>java.lang.Integer</return-type>
                        </auto-increment-table>
                    </key-generator>
                    <ejb-local-ref>
                        <ref-name>ejb/local/Address</ref-name>
                        <name>AddressBean</name>
                    </ejb-local-ref>
                    <resource-ref>
                        <ref-name>jdbc/adventure/AdventureDB</ref-name>
                        <resource-link>AdventureDataSource</resource-link>
                    </resource-ref>
                </entity>
                <entity>
                    <ejb-name>LodgingBean</ejb-name>
                    <jndi-name>LodgingLocalHome</jndi-name>
                    <table-name>Lodging_Bean</table-name>
                    <cmp-field-mapping>
                        <cmp-field-name>startDate</cmp-field-name>
                        <table-column>startDate</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>lodgingId</cmp-field-name>
                        <table-column>lodgingId</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>noNights</cmp-field-name>
                        <table-column>noNights</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>endDate</cmp-field-name>
                        <table-column>endDate</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>location</cmp-field-name>
                        <table-column>location</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>noRooms</cmp-field-name>
                        <table-column>noRooms</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>name</cmp-field-name>
                        <table-column>name</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>pricePerNight</cmp-field-name>
                        <table-column>pricePerNight</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>lodgingBean_upk</cmp-field-name>
                        <cmp-field-class>java.lang.Integer</cmp-field-class>
                        <table-column>LodgingBean_upk</table-column>
                        <sql-type>INTEGER</sql-type>
                        <type-converter>org.tranql.sql.typeconverter.SerializableConverter</type-converter> 
                    </cmp-field-mapping>
                    <primkey-field>lodgingBean_upk</primkey-field>     
                    <key-generator>
                        <auto-increment-table>
                            <sql>INSERT INTO Lodging_Bean VALUES(null,startDate,lodgingId,noNights,endDate,location,noRooms,name,pricePerNight)</sql>
                            <return-type>java.lang.Integer</return-type>
                        </auto-increment-table>
                    </key-generator>
                    <resource-ref>
                        <ref-name>jdbc/adventure/AdventureDB</ref-name>
                        <resource-link>AdventureDataSource</resource-link>
                    </resource-ref>
                </entity>
                <entity>
                    <ejb-name>CreditCardBean</ejb-name>
                    <jndi-name>CreditCardLocalHome</jndi-name>
                    <table-name>CreditCard</table-name>
                    <cmp-field-mapping>
                        <cmp-field-name>cardNumber</cmp-field-name>
                        <table-column>cardNumber</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>cardType</cmp-field-name>
                        <table-column>cardType</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>cardExpiryDate</cmp-field-name>
                        <table-column>cardExpiryDate</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>creditCardBean_upk</cmp-field-name>
                        <cmp-field-class>java.lang.Integer</cmp-field-class>
                        <table-column>CreditCardBean_upk</table-column>
                        <sql-type>INTEGER</sql-type>
                        <type-converter>org.tranql.sql.typeconverter.SerializableConverter</type-converter>
                    </cmp-field-mapping>
                    <primkey-field>creditCardBean_upk</primkey-field>
                    <key-generator>
                        <auto-increment-table>
                            <sql>INSERT INTO CreditCard VALUES(null,cardNumber,cardType,cardExpiryDate)</sql>
                            <return-type>java.lang.Integer</return-type>
                        </auto-increment-table>
                    </key-generator>
                    <resource-ref>
                        <ref-name>jdbc/adventure/AdventureDB</ref-name>
                        <resource-link>AdventureDataSource</resource-link>
                    </resource-ref>
                </entity>
                <entity>
                    <ejb-name>PurchaseOrderBean</ejb-name>
                    <jndi-name>PurchaseOrderLocalHome</jndi-name>
                    <table-name>PurchaseOrder</table-name>
                    <cmp-field-mapping>
                        <cmp-field-name>locale</cmp-field-name>
                        <table-column>locale</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>totalPrice</cmp-field-name>
                        <table-column>totalPrice</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>startDate</cmp-field-name>
                        <table-column>startDate</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>userId</cmp-field-name>
                        <table-column>userId</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>departureCity</cmp-field-name>
                        <table-column>departureCity</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>endDate</cmp-field-name>
                        <table-column>endDate</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>orderDate</cmp-field-name>
                        <table-column>orderDate</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>headCount</cmp-field-name>
                        <table-column>headCount</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>poId</cmp-field-name>
                        <table-column>poId</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>emailId</cmp-field-name>
                        <table-column>emailId</table-column>
                    </cmp-field-mapping>
                    <ejb-local-ref>
                        <ref-name>ejb/local/CreditCard</ref-name>
                        <name>CreditCardBean</name>
                    </ejb-local-ref>
                    <ejb-local-ref>
                        <ref-name>ejb/local/ContactInfo</ref-name>
                        <name>ContactInfoBean</name>
                    </ejb-local-ref>
                    <ejb-local-ref>
                        <ref-name>ejb/local/Activity</ref-name>
                        <name>ActivityBean</name>
                    </ejb-local-ref>
                    <ejb-local-ref>
                        <ref-name>ejb/local/Lodging</ref-name>
                        <name>LodgingBean</name>
                    </ejb-local-ref>
                    <ejb-local-ref>
                        <ref-name>ejb/local/Transportation</ref-name>
                        <name>TransportationBean</name>
                    </ejb-local-ref>
                    <resource-ref>
                        <ref-name>jdbc/adventure/AdventureDB</ref-name>
                        <resource-link>AdventureDataSource</resource-link>
                    </resource-ref>
                </entity>
                <entity>
                    <ejb-name>TransportationBean</ejb-name>
                    <jndi-name>TransportationLocalHome</jndi-name>
                    <table-name>Transportation_Bean</table-name>
                    <cmp-field-mapping>
                        <cmp-field-name>transportationId</cmp-field-name>
                        <table-column>transportationId</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>departureDate</cmp-field-name>
                        <table-column>departureDate</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>destination</cmp-field-name>
                        <table-column>destination</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>travelClass</cmp-field-name>
                        <table-column>travelClass</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>price</cmp-field-name>
                        <table-column>price</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>carrier</cmp-field-name>
                        <table-column>carrier</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>origin</cmp-field-name>
                        <table-column>origin</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>departureTime</cmp-field-name>
                        <table-column>departureTime</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>headCount</cmp-field-name>
                        <table-column>headCount</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>transportationBean_upk</cmp-field-name>
                        <cmp-field-class>java.lang.Integer</cmp-field-class>
                        <table-column>TransportationBean_upk</table-column>
                        <sql-type>INTEGER</sql-type>
                        <type-converter>org.tranql.sql.typeconverter.SerializableConverter</type-converter>
                    </cmp-field-mapping>
                    <primkey-field>transportationBean_upk</primkey-field>    
                    <key-generator>
                        <auto-increment-table>
                            <sql>INSERT INTO Transportation_Bean VALUES(null,transportationId,departureDate,destination,travelClass,price,carrier,origin,departureTime,headCount)</sql>
                            <return-type>java.lang.Integer</return-type>
                        </auto-increment-table>
                    </key-generator>
                    <resource-ref>
                        <ref-name>jdbc/adventure/AdventureDB</ref-name>
                        <resource-link>AdventureDataSource</resource-link>
                    </resource-ref>
                </entity>
                <entity>
                    <ejb-name>ActivityBean</ejb-name>
                    <jndi-name>ActivityLocalHome</jndi-name>
                    <table-name>Activity_Bean</table-name>
                    <cmp-field-mapping>
                        <cmp-field-name>activityId</cmp-field-name>
                        <table-column>activityId</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>startDate</cmp-field-name>
                        <table-column>startDate</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>price</cmp-field-name>
                        <table-column>price</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>endDate</cmp-field-name>
                        <table-column>endDate</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>headCount</cmp-field-name>
                        <table-column>headCount</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>location</cmp-field-name>
                        <table-column>location</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>name</cmp-field-name>
                        <table-column>name</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>activityBean_upk</cmp-field-name>
                        <cmp-field-class>java.lang.Integer</cmp-field-class>
                        <table-column>ActivityBean_upk</table-column>
                        <sql-type>INTEGER</sql-type>
                        <type-converter>org.tranql.sql.typeconverter.SerializableConverter</type-converter>
                    </cmp-field-mapping>
                    <primkey-field>activityBean_upk</primkey-field>
                    <key-generator>
                        <auto-increment-table>
                            <sql>INSERT INTO Activity_Bean VALUES(null,activityId,startDate,price,endDate,headCount,location,name,null)</sql>
                            <return-type>java.lang.Integer</return-type>
                        </auto-increment-table>
                    </key-generator>
                    <resource-ref>
                        <ref-name>jdbc/adventure/AdventureDB</ref-name>
                        <resource-link>AdventureDataSource</resource-link>
                    </resource-ref>
                </entity>
                <message-driven>
                    <ejb-name>CRMBean</ejb-name>
                    <resource-adapter>
                        <resource-link>Adventure Builder JMS Resources</resource-link>
                    </resource-adapter>
                    <activation-config>
                        <activation-config-property>
                            <activation-config-property-name>destination</activation-config-property-name>
                            <activation-config-property-value>jms/opc/CRMQueue</activation-config-property-value>
                        </activation-config-property>
                        <activation-config-property>
                            <activation-config-property-name>destinationType</activation-config-property-name>
                            <activation-config-property-value>javax.jms.Queue</activation-config-property-value>
                        </activation-config-property>
                    </activation-config>
                    <resource-ref>
                        <ref-name>jms/opc/QueueConnectionFactory</ref-name>
                        <resource-link>AdventureBuilderConnectionFactory</resource-link>
                    </resource-ref>
                </message-driven>
            </enterprise-beans>
            <relationships>
                <ejb-relation>
                    <ejb-relation-name>ContactAddressRelations</ejb-relation-name>
                    <ejb-relationship-role>
                        <ejb-relationship-role-name>ContactInfoBean</ejb-relationship-role-name>
                        <relationship-role-source>
                            <ejb-name>ContactInfoBean</ejb-name>
                        </relationship-role-source>
                        <cmr-field>
                            <cmr-field-name>address</cmr-field-name>
                        </cmr-field>
                        <foreign-key-column-on-source/>
                        <role-mapping>
                            <cmr-field-mapping>
                                <key-column>AddressBean_upk</key-column>
                                <foreign-key-column>address</foreign-key-column>
                            </cmr-field-mapping>
                        </role-mapping>
                    </ejb-relationship-role>
                </ejb-relation>
                <ejb-relation>
                    <ejb-relation-name>PurchaseTransportationRelations</ejb-relation-name>
                    <ejb-relationship-role>
                        <ejb-relationship-role-name>PurchaseOrderBean</ejb-relationship-role-name>
                        <relationship-role-source>
                            <ejb-name>PurchaseOrderBean</ejb-name>
                        </relationship-role-source>
                        <cmr-field>
                            <cmr-field-name>returnFlightInfo</cmr-field-name>
                        </cmr-field>
                        <foreign-key-column-on-source/>
                        <role-mapping>
                            <cmr-field-mapping>
                                <key-column>TransportationBean_upk</key-column>
                                <foreign-key-column>returnFlightInfo</foreign-key-column>
                            </cmr-field-mapping>
                        </role-mapping>
                    </ejb-relationship-role>
                </ejb-relation>
                <ejb-relation>
                    <ejb-relation-name>PurchaseLodgingRelations</ejb-relation-name>
                    <ejb-relationship-role>
                        <ejb-relationship-role-name>PurchaseOrderBean</ejb-relationship-role-name>
                        <relationship-role-source>
                            <ejb-name>PurchaseOrderBean</ejb-name>
                        </relationship-role-source>
                        <cmr-field>
                            <cmr-field-name>lodging</cmr-field-name>
                        </cmr-field>
                        <foreign-key-column-on-source/>
                        <role-mapping>
                            <cmr-field-mapping>
                                <key-column>LodgingBean_upk</key-column>
                                <foreign-key-column>lodging</foreign-key-column>
                            </cmr-field-mapping>
                        </role-mapping>
                    </ejb-relationship-role>
                </ejb-relation>
                <ejb-relation>
                    <ejb-relation-name>PurchaseActivityRelations</ejb-relation-name>
                    <ejb-relationship-role>
                        <ejb-relationship-role-name>PurchaseOrderBean</ejb-relationship-role-name>
                        <relationship-role-source>
                            <ejb-name>PurchaseOrderBean</ejb-name>
                        </relationship-role-source>
                        <cmr-field>
                            <cmr-field-name>activities</cmr-field-name>
                        </cmr-field>
                        <role-mapping>
                            <cmr-field-mapping>
                                <key-column>poId</key-column>
                                <foreign-key-column>PurchaseOrderBean_activities</foreign-key-column>
                            </cmr-field-mapping>
                        </role-mapping>
                    </ejb-relationship-role>
                </ejb-relation>
                <ejb-relation>
                    <ejb-relation-name>PurchaseTransportationRelations1</ejb-relation-name>
                    <ejb-relationship-role>
                        <ejb-relationship-role-name>PurchaseOrderBean</ejb-relationship-role-name>
                        <relationship-role-source>
                            <ejb-name>PurchaseOrderBean</ejb-name>
                        </relationship-role-source>
                        <cmr-field>
                            <cmr-field-name>departureFlightInfo</cmr-field-name>
                        </cmr-field>
                        <foreign-key-column-on-source/>
                        <role-mapping>
                            <cmr-field-mapping>
                                <key-column>TransportationBean_upk</key-column>
                                <foreign-key-column>departureFlightInfo</foreign-key-column>
                            </cmr-field-mapping>
                        </role-mapping>
                    </ejb-relationship-role>
                </ejb-relation>
                <ejb-relation>
                    <ejb-relation-name>PurchaseContactRelations</ejb-relation-name>
                    <ejb-relationship-role>
                        <ejb-relationship-role-name>PurchaseOrderBean</ejb-relationship-role-name>
                        <relationship-role-source>
                            <ejb-name>PurchaseOrderBean</ejb-name>
                        </relationship-role-source>
                        <cmr-field>
                            <cmr-field-name>billingInfo</cmr-field-name>
                        </cmr-field>
                        <foreign-key-column-on-source/>
                        <role-mapping>
                            <cmr-field-mapping>
                                <key-column>ContactInfoBean_upk</key-column>
                                <foreign-key-column>billingInfo</foreign-key-column>
                            </cmr-field-mapping>
                        </role-mapping>
                    </ejb-relationship-role>
                </ejb-relation>
                <ejb-relation>
                    <ejb-relation-name>PurchaseContactRelations1</ejb-relation-name>
                    <ejb-relationship-role>
                        <ejb-relationship-role-name>PurchaseOrderBean</ejb-relationship-role-name>
                        <relationship-role-source>
                            <ejb-name>PurchaseOrderBean</ejb-name>
                        </relationship-role-source>
                        <cmr-field>
                            <cmr-field-name>shippingInfo</cmr-field-name>
                        </cmr-field>
                        <foreign-key-column-on-source/>
                        <role-mapping>
                            <cmr-field-mapping>
                                <key-column>ContactInfoBean_upk</key-column>
                                <foreign-key-column>shippingInfo</foreign-key-column>
                            </cmr-field-mapping>
                        </role-mapping>
                    </ejb-relationship-role>
                </ejb-relation>
                <ejb-relation>
                    <ejb-relation-name>PurchaseCreditRelations</ejb-relation-name>
                    <ejb-relationship-role>
                        <ejb-relationship-role-name>PurchaseOrderBean</ejb-relationship-role-name>
                        <relationship-role-source>
                            <ejb-name>PurchaseOrderBean</ejb-name>
                        </relationship-role-source>
                        <cmr-field>
                            <cmr-field-name>creditCard</cmr-field-name>
                        </cmr-field>
                        <foreign-key-column-on-source/>
                        <role-mapping>
                            <cmr-field-mapping>
                                <key-column>CreditCardBean_upk</key-column>
                                <foreign-key-column>creditCard</foreign-key-column>
                            </cmr-field-mapping>
                        </role-mapping>
                    </ejb-relationship-role>
                </ejb-relation>
            </relationships>
        </openejb-jar>
    </module>
    <module>
        <ejb>processmanager-ejb.jar</ejb>
        <openejb-jar xmlns="http://www.openejb.org/xml/ns/openejb-jar" 
            xmlns:naming="http://geronimo.apache.org/xml/ns/naming" 
            xmlns:sys="http://geronimo.apache.org/xml/ns/deployment"
            configId="NOT_USED">
            <cmp-connection-factory>
                <resource-link>AdventureDataSource</resource-link>
            </cmp-connection-factory>
            <enterprise-beans>
                <session>
                    <ejb-name>ProcessManagerBean</ejb-name>
                    <jndi-name>com.sun.j2ee.blueprints.processmanager.ejb.ProcessManagerLocalHome</jndi-name>
                    <local-jndi-name>ProcessManagerLocalHome</local-jndi-name>
                    <ejb-local-ref>
                        <ref-name>ejb/local/processmanager/Manager</ref-name>
                        <name>ManagerBean</name>
                    </ejb-local-ref>
                </session>
                <entity>
                    <ejb-name>ManagerBean</ejb-name>
                    <jndi-name>ManagerLocalHome</jndi-name>
                    <local-jndi-name>ManagerLocalHome</local-jndi-name>
                    <table-name>Manager</table-name>
                    <cmp-field-mapping>
                        <cmp-field-name>lodgingOrderStatus</cmp-field-name>
                        <cmp-field-class>String</cmp-field-class>
                        <table-column>lodgingOrderStatus</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>orderError</cmp-field-name>
                        <cmp-field-class>boolean</cmp-field-class>
                        <table-column>orderError</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>orderId</cmp-field-name>
                        <cmp-field-class>String</cmp-field-class>
                        <table-column>orderId</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>status</cmp-field-name>
                        <cmp-field-class>String</cmp-field-class>
                        <table-column>status</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>activityOrderStatus</cmp-field-name>
                        <cmp-field-class>String</cmp-field-class>
                        <table-column>activityOrderStatus</table-column>
                    </cmp-field-mapping>
                    <cmp-field-mapping>
                        <cmp-field-name>airlineOrderStatus</cmp-field-name>
                        <cmp-field-class>String</cmp-field-class>
                        <table-column>airlineOrderStatus</table-column>
                    </cmp-field-mapping>
                    <primkey-field>orderId</primkey-field>
                    <resource-ref>
                        <ref-name>jdbc/adventure/AdventureDB</ref-name>
                        <resource-link>MysqlDataSource</resource-link>
                    </resource-ref>
                </entity>
            </enterprise-beans>
        </openejb-jar>
    </module>
    <gbean name="mail/MailSession" class="org.apache.geronimo.mail.MailGBean"/>
    <gbean name="mail/MailSession" class="org.apache.geronimo.mail.SMTPTransportGBean">
        <attribute name="host">10.0.0.1</attribute>
        <attribute name="port">25</attribute>
    </gbean>
</application>
