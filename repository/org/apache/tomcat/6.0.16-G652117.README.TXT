Private Build of Tomcat for Geronimo.   

How to build Tomcat 6_0_16 with modifications for Geronimo:

Checkout tomcat 6.0.16
  svn co  https://svn.apache.org/repos/asf/tomcat/tc6.0.x/tags/TOMCAT_6_0_16  tomcat_6_0_16
  
svn info for Tomcat image:
Path: .
URL: https://svn.apache.org/repos/asf/tomcat/tc6.0.x/tags/TOMCAT_6_0_16
Repository Root: https://svn.apache.org/repos/asf
Repository UUID: 13f79535-47bb-0310-9956-ffa450edef68
Revision: 653549
Node Kind: directory
Schedule: normal
Last Changed Author: remm
Last Changed Rev: 616101
Last Changed Date: 2008-01-28 18:01:08 -0500 (Mon, 28 Jan 2008)


Apply the patch

cd tomcat_6_0_16
patch -p0 -u < TOMCAT_6_0_16-G652117.patch
Answer 'y' to any prompts of "Reversed (or previously applied) patch detected!  Assume -R? [n]"

Force delete these three files
  svn delete java/org/apache/jasper/runtime/AnnotationHelper.java --force
  svn delete java/org/apache/AnnotationProcessor.java --force
  svn delete java/org/apache/catalina/util/DefaultAnnotationProcessor.java --force
  
Add the following files
  java/org/apache/InstanceManager.java
  java/org/apache/jasper/runtime/InstanceManagerFactory.java
  java/org/apache/catalina/core/DefaultInstanceManager.java
  java/org/apache/catalina/core/RestrictedListeners.properties
  java/org/apache/catalina/deploy/Injectable.java
  java/org/apache/catalina/deploy/InjectionTarget.java
 
Build tomcat
  cd tomcat_6_0_16
  Per tomcat build instructions install ant-1.6.5 or later and set ANT_HOME as well as add ant/bin to PATH
  You must run as the super user for the first build that downloads more ant & eclipse artifacts
  ant download   - to setup build for tomcat
  Exit super user
  ant - to build tomcat artifacts
  
Copy to appropriate jars and rename into geronimo/repository
  cd tomcat_6_0_16
  cp output/build/lib/catalina.jar <geronimo-root>/repository/org/apache/tomcat/catalina/6.0.16-G652117/catalina-6.0.16-G652117.jar
  cp output/build/lib/jasper.jar   <geronimo-root>/repository/org/apache/tomcat/jasper/6.0.16-G652117/jasper-6.0.16-G652117.jar
  
How the patch was created (tomcat_6_0_16-G652117.patch):

Checkout tomcat 6.0.16
  svn co  https://svn.apache.org/repos/asf/tomcat/tc6.0.x/tags/TOMCAT_6_0_16  tomcat_6_0_16


Apply annotations patch 
  patch -p0 -u < TOMCAT_6_0_14-G604245.patch
  fix patch conflicts

Apply the Webdav security fix patch
  patch -p0 -u < TOMCAT_6_0_14-G614585.patch

Create the patch:
  svn diff > TOMCAT_6_0_16-G652117.patch